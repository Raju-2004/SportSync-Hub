<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title%></title>
    <link rel="stylesheet" href="./style.css">
    <script src="functions.js"></script>
</head>
<body>
    <div class="sessions">
        <% for(let i = 0; i < sessions.length; i++) { %>
            <div class="session">
                <li>players : <%=sessions[i].playersHave%></li>
                <li>available Slots : <%=sessions[i].playersNeeded%></li>
                <li>Start Time: <%= formatDate(sessions[i].startTime) %></li>
                <li>Status: <%= calculateStatus(sessions[i].startTime) %></li>
                <li>Venue : <%=sessions[i].venue%></li>
                <% if(sport == "1") {%>
                    <button><a href="/join-session/<%= sessions[i].id%>">Join session</a></button>
                <%}%>
            </div>
        <% } %>
    </div>    
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title%></title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <script src="functions.js"></script>
  </head>
  <body class="bg-gray-100">
    <%-include('header')%>

    <div class="container mx-auto p-4">
      <h2 class="text-2xl font-bold text-transform: capitalize;">
        <%= title %>
      </h2>
      <div class="sessions">
        <% for(let i = 0; i < sessions.length; i++) { %>
        <div class="session bg-white p-4 rounded-lg shadow-md mb-4">
          <ul class="list-none list-inside text-gray-700">
            <li>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-6 h-6 inline-block mr-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"
                />
              </svg>
              players : <%=sessions[i].players%>
            </li>
            <li>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-6 h-6 inline-block mr-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M20 11a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM5 13a2 2 0 1 1 4 0 2 2 0 0 1-4 0ZM8 21a6 6 0 0 1 4.18-5.68A8 8 0 0 1 12 3a8 8 0 0 1 3.82 15.32A6 6 0 0 1 8 21ZM12 3a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM12 5a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"
                />
              </svg>
              available Slots : <%=sessions[i].playersNeeded%>
            </li>
            <li>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-6 h-6 inline-block mr-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M13 2a1 1 0 0 1 2 0v10a1 1 0 0 1-2 0V2Zm0 12a1 1 0 0 1 2 0v6a1 1 0 0 1-2 0v-6ZM6 6h13a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1Z"
                />
              </svg>
              Start Time: <%= sessions[i].startTime%>
            </li>
            <li>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-6 h-6 inline-block mr-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M22 12h-4l-3 9L9 3l-3 9H2"
                />
              </svg>
              Status: <%= calculateStatus(sessions[i].startTime) %>
            </li>
            <li>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-6 h-6 inline-block mr-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2ZM12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12Z"
                />
              </svg>
              Venue : <%=sessions[i].venue%>
            </li>
          </ul>

          <% if(!sessions[i].cancellation_status) {%>
          <div class="flex justify-start gap-6 mt-4">
            <form action="/join-session/<%= sessions[i].id%>" method="post">
              <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
              <button
                class="bg-indigo-500 text-white py-2 px-4 rounded-lg hover:bg-indigo-600"
                type="submit"
              >
                Join session
              </button>
            </form>
            <button
              onclick="toggleForm('cancelForm<%= sessions[i].id %>')"
              class="bg-indigo-500 text-white py-2 px-4 rounded-lg hover:bg-indigo-600"
              type="submit"
            >
              Cancel session
            </button>
          </div>
          <form
            id="cancelForm<%= sessions[i].id %>"
            action="/cancelSession/<%= sessions[i].id %>"
            method="post"
            class="hidden"
          >
            <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
            <div>
              <label for="reason" class="block text-gray-700 font-bold mb-2"
                >Cancellation Reason:</label
              >
              <input
                type="text"
                id="reason"
                name="reason"
                class="appearance-none block w-full bg-gray-200 border border-gray-200 rounded-md py-2 px-4 leading-tight focus:outline-none focus:bg-white focus:border-purple-500"
              />
            </div>
            <button
              type="submit"
              class="bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 mt-4"
            >
              Confirm Cancellation
            </button>
          </form>

          <%}else{%>
          <form action="/cancelSession/<%= sessions[i].id%>" method="post">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
            <button
              class="cursor-not-allowed bg-indigo-500 mt-4 text-white py-2 px-4 rounded-lg hover:bg-indigo-600"
              type="submit"
            >
              Session Cancelled
            </button>
          </form>
          <%}%>
        </div>
        <% } %>
      </div>
    </div>
    <script>
      function toggleForm(formId) {
        const form = document.getElementById(formId);
        form.classList.toggle("hidden");
      }
    </script>
  </body>
</html>
